<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Detalle de Terreno</title>
    <meta name="description" content="Información detallada del terreno seleccionado, incluyendo fotos, precio y ubicación.">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">
    <img src="img/logo.png" alt="Logo Inkatierra">
    <h1>Inkatierra</h1> 
</a>
<nav>
    <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="terrenos.html">Terrenos</a></li>
        <li><a href="sobre-nosotros.html">Nosotros</a></li>
        <li><a href="vender-terreno.html">¿Quieres Vender?</a></li>
        <li><a href="contacto.html">Contacto</a></li>
    </ul>
    </nav>
            <button class="menu-toggle" aria-label="Abrir menú">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <main class="detail-page">
        <section class="terrain-detail-section">
            <div class="container" id="terrain-detail-container">
                </div>
        </section>

        <section class="contact-form-section">
            <div class="container">
                <h2>¿Interesado en este Terreno?</h2>
                <p>Completa el formulario y nos pondremos en contacto contigo lo antes posible para brindarte más información o agendar una visita.</p>
                <form id="contact-terrain-form" class="simple-form">
                    <div class="form-group">
                        <label for="name">Nombre Completo:</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Correo Electrónico:</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Teléfono:</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Mensaje:</label>
                        <textarea id="message" name="message" rows="5" placeholder="Me gustaría más información sobre este terreno o agendar una visita."></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Enviar Consulta</button>
                    <p class="form-message" id="contact-form-message"></p>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div class="container footer-grid">
            <div class="footer-col about-company">
                <h3>TuTerrenoIdeal</h3>
                <p>Tu socio confiable para la compra y venta de terrenos en Perú. Te acompañamos en cada paso.</p>
                <div class="social-icons">
                    <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" target="_blank" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="footer-col quick-links">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="terrenos.html">Terrenos</a></li>
                    <li><a href="sobre-nosotros.html">Sobre Nosotros</a></li>
                    <li><a href="vender-terreno.html">Vender Terreno</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </div>
            <div class="footer-col contact-info">
                <h3>Contáctanos</h3>
                <p><i class="fas fa-map-marker-alt"></i> Dirección de la Oficina, Ciudad, País</p>
                <p><i class="fas fa-phone-alt"></i> <a href="tel:+51916999032">+51 916 999 032</a></p>
                <p><i class="fas fa-envelope"></i> <a href="mailto:info@tuterrenoideal.com">info@tuterrenoideal.com</a></p>
            </div>
            <div class="footer-col newsletter">
                <h3>Newsletter</h3>
                <p>Suscríbete para recibir nuestras últimas ofertas y noticias.</p>
                <form>
                    <input type="email" placeholder="Tu correo electrónico">
                    <button type="submit" class="btn-secondary">Suscribirse</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <p>&copy; 2025 TuTerrenoIdeal. Todos los derechos reservados.</p>
                <p>
                    <a href="#">Política de Privacidad</a> | 
                    <a href="#">Términos y Condiciones</a>
                </p>
            </div>
        </div>
    </footer>

    <a href="https://wa.me/51916999032" class="whatsapp-float" target="_blank" aria-label="WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script src="js/main.js"></script>
    <script src="js/data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const terrainId = urlParams.get('id');
            const terrainDetailContainer = document.getElementById('terrain-detail-container');
            const pageTitle = document.getElementById('page-title');

            if (!terrainId) {
                terrainDetailContainer.innerHTML = '<p class="error-message">Terreno no especificado. Por favor, regresa al <a href="terrenos.html">listado de terrenos</a>.</p>';
                pageTitle.textContent = 'Terreno No Encontrado';
                return;
            }

            const terrain = terrenosData.find(t => t.id === terrainId);

            if (!terrain) {
                terrainDetailContainer.innerHTML = '<p class="error-message">Lo sentimos, el terreno solicitado no fue encontrado.</p>';
                pageTitle.textContent = 'Terreno No Encontrado';
                return;
            }

            pageTitle.textContent = `${terrain.distrito}, ${terrain.provincia} - TuTerrenoIdeal`;

            let galleryHtml = '<div class="gallery-main-image"><img src="' + terrain.imagenPrincipal + '" alt="Terreno ' + terrain.distrito + '"></div>';
            if (terrain.imagenesAdicionales && terrain.imagenesAdicionales.length > 0) {
                galleryHtml += '<div class="gallery-thumbnails">';
                terrain.imagenesAdicionales.forEach(img => {
                    galleryHtml += `<img src="${img}" alt="Miniatura del terreno" data-src="${img}">`;
                });
                galleryHtml += '</div>';
            }

            const documentsList = terrain.documentos.map(doc => `<li>${doc}</li>`).join('');

            terrainDetailContainer.innerHTML = `
                <div class="terrain-header">
                    <h1>Terreno en ${terrain.distrito}, ${terrain.provincia}</h1>
                    <p class="location-full"><i class="fas fa-map-marker-alt"></i> ${terrain.direccionExacta}</p>
                    <p class="price-detail">Precio: S/ ${terrain.precio.toLocaleString('es-PE')}</p>
                </div>
                <div class="terrain-gallery-details">
                    <div class="terrain-gallery">
                        ${galleryHtml}
                    </div>
                    <div class="terrain-info-box">
                        <h3>Detalles Clave</h3>
                        <ul>
                            <li><strong>Metros Cuadrados:</strong> ${terrain.metrosCuadrados} m²</li>
                            <li><strong>Tipo de Terreno:</strong> ${terrain.tipo}</li>
                            <li><strong>Región:</strong> ${terrain.region}</li>
                            <li><strong>Provincia:</strong> ${terrain.provincia}</li>
                            <li><strong>Distrito:</strong> ${terrain.distrito}</li>
                            <li><strong>Publicado:</strong> ${new Date(terrain.fechaPublicacion).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' })}</li>
                        </ul>
                    </div>
                </div>
                <div class="terrain-description">
                    <h3>Descripción del Terreno</h3>
                    <p>${terrain.descripcion}</p>
                </div>
                <div class="terrain-documents">
                    <h3>Documentación Legal</h3>
                    <ul>
                        ${documentsList}
                    </ul>
                </div>
                <div class="terrain-map">
                    <h3>Ubicación en el Mapa</h3>
                    <div class="map-container">
                        <iframe
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1576.8797871687158!2d${terrain.coordenadas.longitud}!3d${terrain.coordenadas.latitud}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2z${terrain.coordenadas.latitud},${terrain.coordenadas.longitud}!5e0!3m2!1ses!2spe!4v1678912345678!5m2!1ses!2spe"
                            width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy">
                        </iframe>
                    </div>
                </div>
            `;

            // Lógica de la galería de imágenes
            const mainImage = document.querySelector('.gallery-main-image img');
            const thumbnails = document.querySelectorAll('.gallery-thumbnails img');

            thumbnails.forEach(thumbnail => {
                thumbnail.addEventListener('click', () => {
                    mainImage.src = thumbnail.dataset.src;
                });
            });

            // Lógica para el formulario de contacto del terreno (simulado)
            const contactForm = document.getElementById('contact-terrain-form');
            const formMessage = document.getElementById('contact-form-message');

            contactForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                formMessage.textContent = 'Enviando...';
                formMessage.className = 'form-message'; // Reset class

                const formData = new FormData(contactForm);
                const data = Object.fromEntries(formData.entries());
                data.terrainId = terrain.id; // Añadir el ID del terreno al formulario

                // Simulación de envío: En GitHub Pages no se puede enviar directamente a un correo.
                // Podrías usar servicios como Formspree.io, Netlify Forms, Getform.io
                // o un pequeño servicio de backend (AWS Lambda, Google Cloud Functions)
                // si necesitas más control.

                try {
                    // Ejemplo con Formspree (requiere configurar tu formulario en Formspree.io)
                    // const formspreeEndpoint = 'https://formspree.io/f/tu_codigo_formspree'; // ¡Reemplaza con tu código Formspree!
                    // const response = await fetch(formspreeEndpoint, {
                    //     method: 'POST',
                    //     headers: {
                    //         'Content-Type': 'application/json',
                    //         'Accept': 'application/json'
                    //     },
                    //     body: JSON.stringify(data)
                    // });

                    // if (response.ok) {
                    //     formMessage.textContent = '¡Tu consulta ha sido enviada con éxito! Nos pondremos en contacto pronto.';
                    //     formMessage.classList.add('success');
                    //     contactForm.reset();
                    // } else {
                    //     formMessage.textContent = 'Hubo un error al enviar tu consulta. Por favor, inténtalo de nuevo.';
                    //     formMessage.classList.add('error');
                    // }

                    // --- SIMULACIÓN DE ÉXITO PARA GitHub Pages ---
                    await new Promise(resolve => setTimeout(resolve, 1500)); // Simula un retraso de red
                    console.log('Datos enviados (simulado):', data);
                    formMessage.textContent = '¡Tu consulta ha sido enviada con éxito! Nos pondremos en contacto pronto.';
                    formMessage.classList.add('success');
                    contactForm.reset();
                    // ---------------------------------------------

                } catch (error) {
                    console.error('Error al enviar el formulario:', error);
                    formMessage.textContent = 'Hubo un error al enviar tu consulta. Por favor, inténtalo de nuevo.';
                    formMessage.classList.add('error');
                }
            });
        });
    </script>
</body>
</html>
