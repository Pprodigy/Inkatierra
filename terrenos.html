<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terrenos en Venta | TuTerrenoIdeal</title>
    <meta name="description" content="Explora nuestro catálogo completo de terrenos en venta por región, tipo y precio.">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">
    <img src="img/logo.png" alt="Logo Inkatierra">
    <h1>Inkatierra</h1> 
</a>
<nav>
    <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="terrenos.html">Terrenos</a></li>
        <li><a href="sobre-nosotros.html">Nosotros</a></li>
        <li><a href="vender-terreno.html">¿Quieres Vender?</a></li>
        <li><a href="contacto.html">Contacto</a></li>
    </ul>
    </nav>
            <button class="menu-toggle" aria-label="Abrir menú">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <main class="properties-page">
        <section class="hero-subpage" style="background-image: url('img/hero-terrenos.jpg');">
            <div class="overlay"></div>
            <div class="container">
                <h2>Todos Nuestros Terrenos en Venta</h2>
                <p>Explora un vasto catálogo de oportunidades en diversas ubicaciones.</p>
            </div>
        </section>

        <section class="properties-list-section">
            <div class="container">
                <div class="properties-layout">
                    <aside class="sidebar-filters">
                        <h3>Filtros de Búsqueda</h3>
                        <form id="filter-form">
                            <div class="filter-group">
                                <label for="filter-price-min">Precio Mínimo</label>
                                <input type="number" id="filter-price-min" placeholder="Desde S/">
                            </div>
                            <div class="filter-group">
                                <label for="filter-price-max">Precio Máximo</label>
                                <input type="number" id="filter-price-max" placeholder="Hasta S/">
                            </div>
                            <div class="filter-group">
                                <label for="filter-region">Región</label>
                                <select id="filter-region">
                                    <option value="">Todas</option>
                                    <option value="Lima">Lima</option>
                                    <option value="Junin">Junín</option>
                                    </select>
                            </div>
                            <div class="filter-group">
                                <label for="filter-province">Provincia</label>
                                <select id="filter-province">
                                    <option value="">Todas</option>
                                    </select>
                            </div>
                            <div class="filter-group">
                                <label for="filter-district">Distrito</label>
                                <select id="filter-district">
                                    <option value="">Todos</option>
                                    </select>
                            </div>
                            <div class="filter-group">
                                <label for="filter-type">Tipo de Terreno</label>
                                <select id="filter-type">
                                    <option value="">Todos</option>
                                    <option value="urbano">Urbano</option>
                                    <option value="rustico">Rústico</option>
                                    <option value="chacra">Chacra</option>
                                    <option value="con-casa">Con Construcción</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="filter-sqm-min">Metros Cuadrados Mínimos</label>
                                <input type="number" id="filter-sqm-min" placeholder="Desde m²">
                            </div>
                            <div class="filter-group">
                                <label for="filter-sqm-max">Metros Cuadrados Máximos</label>
                                <input type="number" id="filter-sqm-max" placeholder="Hasta m²">
                            </div>
                            <button type="submit" class="btn-primary">Aplicar Filtros</button>
                            <button type="button" class="btn-secondary" id="reset-filters">Limpiar Filtros</button>
                        </form>
                    </aside>

                    <div class="properties-content">
                        <div class="sort-options">
                            <label for="sort-by">Ordenar por:</label>
                            <select id="sort-by">
                                <option value="date-desc">Más Recientes</option>
                                <option value="date-asc">Más Antiguos</option>
                                <option value="price-asc">Precio: Menor a Mayor</option>
                                <option value="price-desc">Precio: Mayor a Menor</option>
                            </select>
                        </div>
                        <div class="property-grid" id="all-terrains">
                            </div>
                        <div class="pagination" id="pagination-controls">
                            </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container footer-grid">
            <div class="footer-col about-company">
                <h3>Inkatierra</h3>
                <p>Tu socio confiable para la compra y venta de terrenos en Perú. Te acompañamos en cada paso.</p>
                <div class="social-icons">
                    <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" target="_blank" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="footer-col quick-links">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="terrenos.html">Terrenos</a></li>
                    <li><a href="sobre-nosotros.html">Sobre Nosotros</a></li>
                    <li><a href="vender-terreno.html">Vender Terreno</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </div>
            <div class="footer-col contact-info">
                <h3>Contáctanos</h3>
                <p><i class="fas fa-map-marker-alt"></i> Jirón Junín #319, Satipo - Junín, Perú </p>
                <p><i class="fas fa-phone-alt"></i> <a href="tel:+51916999032">+51 916 999 032</a></p>
                <p><i class="fas fa-envelope"></i> <a href="mailto:info@tuterrenoideal.com">inkatierra@gmail.com</a></p>
            </div>
            <div class="footer-col newsletter">
                <h3>Te notificamos</h3>
                <p>Suscríbete para recibir nuestras últimas ofertas y noticias.</p>
                <form>
                    <input type="email" placeholder="Tu correo electrónico">
                    <button type="submit" class="btn-secondary">Suscribirse</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <p>&copy; 2025 Inkatierra. Todos los derechos reservados.</p>
                <p>
                    <a href="#">Política de Privacidad</a> | 
                    <a href="#">Términos y Condiciones</a>
                </p>
            </div>
        </div>
    </footer>

    <a href="https://wa.me/51916999032" class="whatsapp-float" target="_blank" aria-label="WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script src="js/main.js"></script>
    <script src="js/data.js"></script>
    <script>
        // Lógica de carga para terrenos.html
        document.addEventListener('DOMContentLoaded', () => {
            const terrainsPerPage = 6; // Mostrar 2 terrenos por fila (3 filas)
            let currentPage = 1;
            let filteredTerrains = [];

            const allTerrainsContainer = document.getElementById('all-terrains');
            const paginationControls = document.getElementById('pagination-controls');
            const filterForm = document.getElementById('filter-form');
            const resetFiltersBtn = document.getElementById('reset-filters');
            const sortBySelect = document.getElementById('sort-by');
            const filterRegionSelect = document.getElementById('filter-region');
            const filterProvinceSelect = document.getElementById('filter-province');
            const filterDistrictSelect = document.getElementById('filter-district');

            // Cargar provincias y distritos para los filtros
            function populateLocationFilters() {
                const regions = [...new Set(terrenosData.map(t => t.region))];
                filterRegionSelect.innerHTML = '<option value="">Todas</option>' + regions.map(r => `<option value="${r}">${r}</option>`).join('');

                filterRegionSelect.addEventListener('change', () => {
                    const selectedRegion = filterRegionSelect.value;
                    const provincesInRegion = [...new Set(terrenosData.filter(t => t.region === selectedRegion).map(t => t.provincia))];
                    filterProvinceSelect.innerHTML = '<option value="">Todas</option>' + provincesInRegion.map(p => `<option value="${p}">${p}</option>`).join('');
                    filterDistrictSelect.innerHTML = '<option value="">Todos</option>'; // Reset districts
                });

                filterProvinceSelect.addEventListener('change', () => {
                    const selectedProvince = filterProvinceSelect.value;
                    const selectedRegion = filterRegionSelect.value; // Necesario si queremos filtrar distritos por provincia y región
                    const districtsInProvince = [...new Set(terrenosData.filter(t => t.region === selectedRegion && t.provincia === selectedProvince).map(t => t.distrito))];
                    filterDistrictSelect.innerHTML = '<option value="">Todos</option>' + districtsInProvince.map(d => `<option value="${d}">${d}</option>`).join('');
                });
            }

            // Función para renderizar los terrenos
            function renderTerrains(terrainsToDisplay) {
                allTerrainsContainer.innerHTML = '';
                if (terrainsToDisplay.length === 0) {
                    allTerrainsContainer.innerHTML = '<p class="no-results">No se encontraron terrenos que coincidan con los filtros aplicados.</p>';
                    paginationControls.innerHTML = '';
                    return;
                }

                const startIndex = (currentPage - 1) * terrainsPerPage;
                const endIndex = startIndex + terrainsPerPage;
                const paginatedTerrains = terrainsToDisplay.slice(startIndex, endIndex);

                paginatedTerrains.forEach(terrain => {
                    const terrainCard = `
                        <div class="property-card">
                            <img src="${terrain.imagenPrincipal}" alt="Terreno en ${terrain.distrito}">
                            <div class="property-info">
                                <h3>${terrain.distrito}, ${terrain.provincia}</h3>
                                <p class="location">${terrain.region}</p>
                                <p class="details">${terrain.metrosCuadrados} m² - ${terrain.tipo}</p>
                                <p class="price">S/ ${terrain.precio.toLocaleString('es-PE')}</p>
                                <a href="detalle-terreno.html?id=${terrain.id}" class="btn-card-detail">Ver Detalles</a>
                            </div>
                        </div>
                    `;
                    allTerrainsContainer.innerHTML += terrainCard;
                });
                renderPagination(terrainsToDisplay.length);
            }

            // Función para renderizar la paginación
            function renderPagination(totalTerrains) {
                paginationControls.innerHTML = '';
                const totalPages = Math.ceil(totalTerrains / terrainsPerPage);

                if (totalPages <= 1) return; // No mostrar paginación si solo hay una página

                const createPageButton = (page, text, isDisabled = false) => {
                    const button = document.createElement('button');
                    button.textContent = text;
                    button.classList.add('page-button');
                    if (page === currentPage) {
                        button.classList.add('active');
                    }
                    if (isDisabled) {
                        button.disabled = true;
                    }
                    button.addEventListener('click', () => {
                        currentPage = page;
                        renderTerrains(filteredTerrains);
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    });
                    return button;
                };

                // Botón "Anterior"
                paginationControls.appendChild(createPageButton(currentPage - 1, 'Anterior', currentPage === 1));

                // Números de página
                let startPage = Math.max(1, currentPage - 2);
                let endPage = Math.min(totalPages, currentPage + 2);

                if (startPage > 1) {
                    paginationControls.appendChild(createPageButton(1, '1'));
                    if (startPage > 2) {
                        const dots = document.createElement('span');
                        dots.textContent = '...';
                        paginationControls.appendChild(dots);
                    }
                }

                for (let i = startPage; i <= endPage; i++) {
                    paginationControls.appendChild(createPageButton(i, i.toString()));
                }

                if (endPage < totalPages) {
                    if (endPage < totalPages - 1) {
                        const dots = document.createElement('span');
                        dots.textContent = '...';
                        paginationControls.appendChild(dots);
                    }
                    paginationControls.appendChild(createPageButton(totalPages, totalPages.toString()));
                }

                // Botón "Siguiente"
                paginationControls.appendChild(createPageButton(currentPage + 1, 'Siguiente', currentPage === totalPages));
            }

            // Función para aplicar filtros y ordenar
            function applyFiltersAndSort() {
                let currentTerrains = [...terrenosData];

                const minPrice = parseFloat(document.getElementById('filter-price-min').value);
                const maxPrice = parseFloat(document.getElementById('filter-price-max').value);
                const region = document.getElementById('filter-region').value;
                const province = document.getElementById('filter-province').value;
                const district = document.getElementById('filter-district').value;
                const type = document.getElementById('filter-type').value;
                const minSqm = parseFloat(document.getElementById('filter-sqm-min').value);
                const maxSqm = parseFloat(document.getElementById('filter-sqm-max').value);
                const sortBy = sortBySelect.value;

                filteredTerrains = currentTerrains.filter(terrain => {
                    return (isNaN(minPrice) || terrain.precio >= minPrice) &&
                           (isNaN(maxPrice) || terrain.precio <= maxPrice) &&
                           (region === '' || terrain.region === region) &&
                           (province === '' || terrain.provincia === province) &&
                           (district === '' || terrain.distrito === district) &&
                           (type === '' || terrain.tipo.toLowerCase().includes(type.toLowerCase())) &&
                           (isNaN(minSqm) || terrain.metrosCuadrados >= minSqm) &&
                           (isNaN(maxSqm) || terrain.metrosCuadrados <= maxSqm);
                });

                // Ordenar resultados
                filteredTerrains.sort((a, b) => {
                    if (sortBy === 'price-asc') return a.precio - b.precio;
                    if (sortBy === 'price-desc') return b.precio - a.precio;
                    if (sortBy === 'date-asc') return new Date(a.fechaPublicacion) - new Date(b.fechaPublicacion);
                    if (sortBy === 'date-desc') return new Date(b.fechaPublicacion) - new Date(a.fechaPublicacion);
                    return 0; // Default or no sort
                });

                currentPage = 1; // Reset a la primera página al aplicar filtros
                renderTerrains(filteredTerrains);
            }

            // Event Listeners
            filterForm.addEventListener('submit', (e) => {
                e.preventDefault();
                applyFiltersAndSort();
            });

            resetFiltersBtn.addEventListener('click', () => {
                filterForm.reset();
                populateLocationFilters(); // Re-populate based on all data
                applyFiltersAndSort();
            });

            sortBySelect.addEventListener('change', () => {
                applyFiltersAndSort();
            });

            // Inicialización
            populateLocationFilters();
            applyFiltersAndSort(); // Renderiza los terrenos iniciales y aplica el orden por defecto
        });
    </script>
</body>
</html>
